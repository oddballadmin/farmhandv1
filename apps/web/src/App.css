/* Theme tokens using your palette, system-aware with manual override */
:root {
	color-scheme: light dark;

	/* Base palette variables */
	--color-dark-bg: #0b1220; /* deep navy */
	--color-light-bg: #f8fafc; /* slate-50 */
	--color-primary-text: #0f172a; /* slate-900 */
	--color-secondary-text: #6366f1; /* indigo-500 (accent) */
	--color-mod-bg-dark: #111827; /* slate-900 surface */
	--color-mod-bg-light: #ffffff; /* pure white surface */
	--color-positive: #22c55e; /* green-500 */
	--color-negative: #ef4444; /* red-500 */

	/* Derived background companions for smoother gradients */
	--color-dark-bg-2: #111827; /* companion to dark bg */
	--color-light-bg-2: #f1f5f9; /* slate-100 */

	/* Mode mapping variables (LIGHT by default) */
	--page-bg-1: var(--color-light-bg);      /* page background base */
	--page-bg-2: var(--color-light-bg-2);    /* page background companion */
	--surface-bg: var(--color-light-bg-2);   /* header/sidebar surface (slightly darker than page) */
	--panel-bg: var(--color-mod-bg-light);   /* module panels (white for strong separation) */

	/* Semantic tokens (defined once) */
	--fg: var(--color-primary-text);
	--fg-secondary: var(--color-secondary-text);

	/* Page/content backgrounds (use mode mapping) */
	--bg: linear-gradient(145deg, var(--page-bg-1) 0%, color-mix(in oklab, var(--page-bg-1) 60%, var(--page-bg-2) 40%) 35%, var(--page-bg-2) 100%);
	--main-bg: linear-gradient(145deg, var(--page-bg-1) 0%, color-mix(in oklab, var(--page-bg-1) 60%, var(--page-bg-2) 40%) 35%, var(--page-bg-2) 100%);

	/* Header/sidebar surfaces and borders */
	--header-bg: var(--surface-bg);
	--header-border: var(--border-color);
	--sidebar-bg: var(--surface-bg);
	--sidebar-border: var(--border-color);
	--header-surface: linear-gradient(135deg, var(--surface-bg) 0%, var(--page-bg-1) 100%);
	--sidebar-surface: linear-gradient(135deg, var(--surface-bg) 0%, var(--page-bg-1) 100%);

	/* Panels and borders */
	--module-panel-bg: var(--panel-bg);
	--module-panel-border: var(--border-color);
	--border-color: #e2e8f0; /* light neutral border */

	/* Elevation (non-color, keep constant) */
	--elevation-1: 0 1px 2px rgba(0, 0, 0, 0.04);
	--elevation-2: 0 4px 8px rgba(0, 0, 0, 0.06);

	/* Buttons */
	--menu-btn-border: var(--border-color);
	--menu-btn-hover-bg: var(--page-bg-1);
	--action-btn-bg: var(--color-secondary-text);
	--action-btn-hover-bg: var(--color-primary-text);
	--action-btn-color: #ffffff;

	/* Nav */
	--nav-link-color: var(--color-primary-text);
	--nav-link-hover-bg: var(--surface-bg);
	--nav-link-hover-color: var(--color-primary-text);
	--nav-link-active-bg: var(--color-secondary-text);
	--nav-link-active-color: #ffffff;

	/* Sub-menu */
	--sub-menu-border-color: var(--color-primary-text);
	--sub-menu-active-bg: var(--color-secondary-text);
	--sub-menu-active-color: #ffffff;

	/* Signals */
	--positive-color: var(--color-positive);
	--negative-color: var(--color-negative);

	/* Typography */
	--font-body: 'Noto Serif', ui-serif, Georgia, Cambria, Times, 'Times New Roman', serif;
	--font-heading: 'Oswald', ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, 'Helvetica Neue', sans-serif;
}

/* Typography: headings letter-spacing (body spacing unchanged) */
h1, h2, h3, h4, h5, h6 {
	letter-spacing: 0.02em; /* subtle expansion for Oswald */
	font-family: var(--font-heading);
}

h1 { letter-spacing: 0.025em; }
h2 { letter-spacing: 0.02em; }
h3 { letter-spacing: 0.015em; }
h4 { letter-spacing: 0.01em; }
h5 { letter-spacing: 0.01em; }
h6 { letter-spacing: 0.005em; }

/* System DARK preference: swap page/module tones */
@media (prefers-color-scheme: dark) {
	:root {
		/* Override only mode mapping for DARK */
		--page-bg-1: var(--color-dark-bg);
		--page-bg-2: var(--color-dark-bg-2);
		--surface-bg: color-mix(in oklab, var(--color-dark-bg-2) 80%, #1f2937 20%); /* slightly lighter surface */
		--panel-bg: #1f2937; /* panels lighter than page and surface */

		/* Ensure readable text on dark */
		--color-primary-text: #e5e7eb; /* slate-200 */
		--color-secondary-text: #8b5cf6; /* violet-500 accent */

		/* Borders and elevation tuned for dark */
		--border-color: #334155; /* slate-700 */
		--elevation-1: 0 1px 2px rgba(0,0,0,0.4);
		--elevation-2: 0 8px 24px rgba(0,0,0,0.45);

		/* Nav and controls in dark: softer hover, clear active */
		--nav-link-hover-bg: #1f2937;
		--nav-link-active-bg: var(--color-secondary-text);
		--nav-link-active-color: #ffffff;
		--menu-btn-border: var(--border-color);
	}
}

/* Manual override: force LIGHT */
:root[data-theme="light"] {
	/* Manual LIGHT: override only mode mapping */
	--page-bg-1: var(--color-light-bg);
	--page-bg-2: var(--color-light-bg-2);
	--surface-bg: #e5e7eb; /* slightly darker than page */
	--panel-bg: var(--color-mod-bg-light); /* pure white for modules */
	/* Ensure strong text contrast in light */
	--color-primary-text: #0f172a;
	--color-secondary-text: #4f46e5; /* indigo-600 for better legibility on light */
}

/* Manual override: force DARK */
:root[data-theme="dark"] {
	/* Manual DARK: override only mode mapping */
	--page-bg-1: var(--color-dark-bg);
	--page-bg-2: var(--color-dark-bg-2);
	--surface-bg: color-mix(in oklab, var(--color-dark-bg-2) 80%, #1f2937 20%);
	--panel-bg: #1f2937;

	/* Ensure readable text on dark */
	--color-primary-text: #e5e7eb; /* slate-200 */
	--color-secondary-text: #8b5cf6; /* violet-500 accent */

	/* Borders and elevation tuned for dark */
	--border-color: #334155; /* slate-700 */
	--elevation-1: 0 1px 2px rgba(0,0,0,0.4);
	--elevation-2: 0 8px 24px rgba(0,0,0,0.45);

	/* Nav and controls in dark */
	--nav-link-hover-bg: #1f2937;
	--nav-link-active-bg: var(--color-secondary-text);
	--nav-link-active-color: #ffffff;
	--menu-btn-border: var(--border-color);
}
